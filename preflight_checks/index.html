



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Preflight checks - Qlik Sense on Kubernetes CLI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#4caf50">
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="green" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#preflight-checks" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Qlik Sense on Kubernetes CLI" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Qlik Sense on Kubernetes CLI
            </span>
            <span class="md-header-nav__topic">
              
                Preflight checks
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/qlik-oss/sense-installer/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Qlik Sense on Kubernetes CLI" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Qlik Sense on Kubernetes CLI
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/qlik-oss/sense-installer/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../getting_started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../command_reference/" title="CLI reference" class="md-nav__link">
      CLI reference
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../concepts/" title="How CLI works" class="md-nav__link">
      How CLI works
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../air_gap/" title="Air gap" class="md-nav__link">
      Air gap
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/qlik-oss/sense-installer/releases" title="Releases ⧉" class="md-nav__link">
      Releases ⧉
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dns-check" class="md-nav__link">
    DNS check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-version-check" class="md-nav__link">
    Kubernetes version check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-check" class="md-nav__link">
    Service check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-check" class="md-nav__link">
    Deployment check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pod-check" class="md-nav__link">
    Pod check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-role-check" class="md-nav__link">
    Create-Role check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-rolebinding-check" class="md-nav__link">
    Create-RoleBinding check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-serviceaccount-check" class="md-nav__link">
    Create-ServiceAccount check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#createrb-check" class="md-nav__link">
    CreateRB check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mongodb-check" class="md-nav__link">
    Mongodb check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-all-checks" class="md-nav__link">
    Running all checks
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/qlik-oss/sense-installer/edit/master/docs/preflight_checks.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="preflight-checks">Preflight checks<a class="headerlink" href="#preflight-checks" title="Permanent link">&para;</a></h1>
<p>Preflight checks provide pre-installation cluster conformance testing and validation before we install qliksense on the cluster. We gather a suite of conformance tests that can be easily written and run on the target cluster to verify that cluster-specific requirements are met.</p>
<p>We support the following tests at the moment as part of preflight checks, and the range of the suite will be expanded in future.</p>
<p>Run the following command to view help about the commands supported by preflight at any moment:
<div class="codehilite"><pre><span></span>$ qliksense preflight
perform preflight checks on the cluster

Usage:
  qliksense preflight <span class="o">[</span>command<span class="o">]</span>

Examples:
qliksense preflight &lt;preflight_check_to_run&gt;

Available Commands:
  all         perform all checks
  dns         perform preflight dns check
  k8s-version check k8s version

Flags:
  -h, --help   <span class="nb">help</span> <span class="k">for</span> preflight
</pre></div></p>
<h3 id="dns-check">DNS check<a class="headerlink" href="#dns-check" title="Permanent link">&para;</a></h3>
<p>Run the following command to perform preflight DNS check. We setup a kubernetes deployment and try to reach it as part of establishing DNS connectivity in this check. 
The expected output should be similar to the one shown below.
<div class="codehilite"><pre><span></span>$ qliksense preflight dns

Preflight DNS check
---------------------
Created deployment <span class="s2">&quot;dep-dns-preflight-check&quot;</span>
Created service <span class="s2">&quot;svc-dns-pf-check&quot;</span>
Created pod: pf-pod-1
Fetching pod: pf-pod-1
Fetching pod: pf-pod-1
Exec-ing into the container...
Preflight DNS check: PASSED
Completed preflight DNS check
Cleaning up resources...
Deleted pod: pf-pod-1
Deleted service: svc-dns-pf-check
Deleted deployment: dep-dns-preflight-check
</pre></div></p>
<h3 id="kubernetes-version-check">Kubernetes version check<a class="headerlink" href="#kubernetes-version-check" title="Permanent link">&para;</a></h3>
<p>We check the version of the target kubernetes cluster and ensure that it falls in the valid range of kubernetes versions that are supported by qliksense. 
The command to run this check and the expected similar output are as shown below:
<div class="codehilite"><pre><span></span>$ qliksense preflight k8s-version

Preflight kubernetes minimum version check
------------------------------------------
Kubernetes API Server version: v1.15.5
Current K8s Version: <span class="m">1</span>.15.5
Current <span class="m">1</span>.15.5 is greater than minimum required version:1.11.0, hence good to go
Preflight minimum kubernetes version check: PASSED
Completed Preflight kubernetes minimum version check
</pre></div></p>
<h3 id="service-check">Service check<a class="headerlink" href="#service-check" title="Permanent link">&para;</a></h3>
<p>We use the commmand below to test if we are able to create a service in the cluster.
<div class="codehilite"><pre><span></span>$ qliksense preflight service

Preflight service check
-----------------------

Preflight service check: 
Created service <span class="s2">&quot;svc-pf-check&quot;</span>
Preflight service creation check: PASSED
Cleaning up resources...
Deleted service: svc-pf-check
Completed preflight service check
</pre></div></p>
<h3 id="deployment-check">Deployment check<a class="headerlink" href="#deployment-check" title="Permanent link">&para;</a></h3>
<p>We use the commmand below to test if we are able to create a deployment in the cluster. After the test exexutes, we wait until the created deployment terminates before we exit the command. 
<div class="codehilite"><pre><span></span>$ qliksense preflight deployment

Preflight deployment check
-----------------------
Preflight deployment check: 
Created deployment <span class="s2">&quot;deployment-preflight-check&quot;</span>
Preflight Deployment check: PASSED
Cleaning up resources...
Deleted deployment: deployment-preflight-check
Completed preflight deployment check
</pre></div></p>
<h3 id="pod-check">Pod check<a class="headerlink" href="#pod-check" title="Permanent link">&para;</a></h3>
<p>We use the commmand below to test if we are able to create a pod in the cluster.
<div class="codehilite"><pre><span></span>$ qliksense preflight pod

Preflight pod check
--------------------

Preflight pod check: 
Created pod: pod-pf-check
Preflight pod creation check: PASSED
Cleaning up resources...
Deleted pod: pod-pf-check
Completed preflight pod check
</pre></div></p>
<h3 id="create-role-check">Create-Role check<a class="headerlink" href="#create-role-check" title="Permanent link">&para;</a></h3>
<p>We use the command below to test if we are able to create a role in the cluster
<div class="codehilite"><pre><span></span>$ qliksense preflight create-role
Preflight create-role check
---------------------------
Preflight create-role check: 
Created role: role-preflight-check
Preflight create-role check: PASSED
Cleaning up resources...
Deleted role: role-preflight-check

Completed preflight create-role check
</pre></div></p>
<h3 id="create-rolebinding-check">Create-RoleBinding check<a class="headerlink" href="#create-rolebinding-check" title="Permanent link">&para;</a></h3>
<p>We use the command below to test if we are able to create a role binding in the cluster
<div class="codehilite"><pre><span></span>$ qliksense preflight createRoleBinding

Preflight create roleBinding check
---------------------------
Preflight createRoleBinding check: 
Created RoleBinding: role-binding-preflight-check
Preflight createRoleBinding check: PASSED
Cleaning up resources...
Deleting RoleBinding: role-binding-preflight-check
Deleted RoleBinding: role-binding-preflight-check

Completed preflight createRoleBinding check
</pre></div></p>
<h3 id="create-serviceaccount-check">Create-ServiceAccount check<a class="headerlink" href="#create-serviceaccount-check" title="Permanent link">&para;</a></h3>
<p>We use the command below to test if we are able to create a service account in the cluster
<div class="codehilite"><pre><span></span>$ qliksense preflight createServiceAccount

Preflight create ServiceAccount check
-------------------------------------
Preflight createServiceAccount check: 
Created Service Account: preflight-check-test-serviceaccount
Preflight createServiceAccount check: PASSED
Cleaning up resources...
Deleting ServiceAccount: preflight-check-test-serviceaccount
Deleted ServiceAccount: preflight-check-test-serviceaccount

Completed preflight createServiceAccount check
</pre></div></p>
<h3 id="createrb-check">CreateRB check<a class="headerlink" href="#createrb-check" title="Permanent link">&para;</a></h3>
<p>We use the command below to combine creation of role, role binding, and service account tests
<div class="codehilite"><pre><span></span>$ qliksense preflight createRB

Preflight createRB check
-------------------------------------
Preflight create-role check: 
Created role: role-preflight-check
Preflight create-role check: PASSED
Cleaning up resources...
Deleted role: role-preflight-check

Completed preflight create-role check

Preflight create RoleBinding check: 
Created RoleBinding: role-binding-preflight-check
Preflight create RoleBinding check: PASSED
Cleaning up resources...
Deleted RoleBinding: role-binding-preflight-check

Completed preflight create RoleBinding check

Preflight createServiceAccount check: 
Created Service Account: preflight-check-test-serviceaccount
Preflight createServiceAccount check: PASSED
Cleaning up resources...
Deleted ServiceAccount: preflight-check-test-serviceaccount

Completed preflight createServiceAccount check
Completed preflight CreateRB check
</pre></div></p>
<h3 id="mongodb-check">Mongodb check<a class="headerlink" href="#mongodb-check" title="Permanent link">&para;</a></h3>
<p>We can check if we are able to connect to an instance of mongodb on the cluster by either supplying the mongodbUri as part of the command or infer it from the current context.</p>
<div class="codehilite"><pre><span></span>qliksense preflight mongo --url<span class="o">=</span>&lt;url&gt; OR
qliksense preflight mongo
qliksense preflight mongo --url<span class="o">=</span>&lt;mongo-server url&gt; --ca-cert<span class="o">=</span>&lt;path to ca-cert file&gt;


Preflight mongo check
---------------------
Preflight mongodb check: 
Created pod: pf-mongo-pod
stdout: MongoDB shell version v4.2.5
connecting to: &lt;url&gt;/?compressors<span class="o">=</span>disabled<span class="p">&amp;</span><span class="nv">gssapiServiceName</span><span class="o">=</span>mongodb
Implicit session: session <span class="o">{</span> <span class="s2">&quot;id&quot;</span> : UUID<span class="o">(</span><span class="s2">&quot;...&quot;</span><span class="o">)</span> <span class="o">}</span>
MongoDB server version: <span class="m">4</span>.2.5
bye
stderr: 
Preflight mongo check: PASSED
Deleted pod: pf-mongo-pod
Completed preflight mongodb check
</pre></div>

<h3 id="running-all-checks">Running all checks<a class="headerlink" href="#running-all-checks" title="Permanent link">&para;</a></h3>
<p>Run the command shown below to execute all preflight checks.
<div class="codehilite"><pre><span></span>$ qliksense preflight all --mongodb-url<span class="o">=</span>&lt;url&gt; OR
$ qliksense preflight all --mongodb-url<span class="o">=</span>&lt;mongo-server url&gt; --mongodb-ca-cert<span class="o">=</span>&lt;path to ca-cert file&gt; 

Running all preflight checks

Preflight DNS check
-------------------
Created deployment <span class="s2">&quot;dep-dns-preflight-check&quot;</span>
Created service <span class="s2">&quot;svc-dns-pf-check&quot;</span>
Created pod: pf-pod-1
Fetching pod: pf-pod-1
Fetching pod: pf-pod-1
Exec-ing into the container...
Preflight DNS check: PASSED
Completed preflight DNS check
Cleaning up resources...
Deleted pod: pf-pod-1
Deleted service: svc-dns-pf-check
Deleted deployment: dep-dns-preflight-check

Preflight kubernetes minimum version check
------------------------------------------
Kubernetes API Server version: v1.15.5
Current K8s Version: <span class="m">1</span>.15.5
Current <span class="m">1</span>.15.5 is greater than minimum required version:1.11.0, hence good to go
Preflight minimum kubernetes version check: PASSED
Completed Preflight kubernetes minimum version check
...
...
All preflight checks have PASSED
Completed running all preflight checks
</pre></div></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>